(this["webpackJsonpDVKN-frontend"]=this["webpackJsonpDVKN-frontend"]||[]).push([[3],{526:function(e,t,a){"use strict";a.d(t,"e",(function(){return o})),a.d(t,"c",(function(){return b})),a.d(t,"a",(function(){return u})),a.d(t,"f",(function(){return y})),a.d(t,"d",(function(){return x})),a.d(t,"b",(function(){return I}));var n,i,c=a(5),r="0",l="1",s="2",d="3",m="4",o=(n={},Object(c.a)(n,r,"Kim"),Object(c.a)(n,l,"M\u1ed9c"),Object(c.a)(n,s,"Th\u1ed5"),Object(c.a)(n,d,"Th\u1ee7y"),Object(c.a)(n,m,"H\u1ecfa"),n),b=Object.keys(o).map((function(e){return{value:e,label:o[e]}})),u={CIVILIAN:"0",WORKER:"1",DIGNITARY:"2",DIVINE:"3",WILD:"4",INVADER:"5",DEMON:"6"},j=u.CIVILIAN,h=u.WORKER,f=u.DIGNITARY,O=u.DIVINE,v=u.WILD,p=u.INVADER,g=u.DEMON,y=(i={},Object(c.a)(i,j,"D\xe2n th\u01b0\u1eddng"),Object(c.a)(i,h,"S\u1ea3n xu\u1ea5t"),Object(c.a)(i,f,"Ch\u1ee9c s\u1eafc"),Object(c.a)(i,O,"Th\u1ea7n t\u1ed9c"),Object(c.a)(i,v,"Hoang d\xe3"),Object(c.a)(i,p,"Gi\u1eb7c"),Object(c.a)(i,g,"Ma t\u1ed9c"),i),x=Object.keys(y).map((function(e){return{value:e,label:y[e]}})),I={id:"",name:"",type:j,element:r,thumbnail:"",imgThumbnail:null,probability_register:"100",description:"",attack:"50",defend:"50",army:"50"}},527:function(e,t,a){},528:function(e,t,a){"use strict";var n,i=a(13),c=a(11),r=a(519),l=a(510),s=a(23),d=a(119),m=a(0),o=a(5),b=a(526),u=!1,j=0,h={elementMetal:"element-metal",elementWood:"element-wood",elementEarth:"element-earth",elementWater:"element-water",elementFire:"element-fire",star:"star",inactiveStarMetal:"inactive-star-metal",inactiveStarWood:"inactive-star-wood",inactiveStarEarth:"inactive-star-earth",inactiveStarWater:"inactive-star-water",inactiveStarFire:"inactive-star-fire",frame:"frame",typeCivilian:"type-civilian",typeWorker:"type-worker",typeDignitary:"type-dignitary",typeDivine:"type-divine",typeWild:"type-wild",typeInvader:"type-invader",typeDemon:"type-demon",typeFrame:"type-frame"},f=Object.keys(h).length,O=function(){(j+=1)===f&&(u=!0)},v={};Object.keys(h).forEach((function(e){var t="img".concat(e[0].toUpperCase()).concat(e.slice(1));v[t]=new Image,v[t].src="/create-card/".concat(h[e],".png"),v[t].onload=O}));var p,g,y=v.imgElementMetal,x=v.imgElementWood,I=v.imgElementEarth,N=v.imgElementWater,w=v.imgElementFire,E=v.imgStar,T=v.imgInactiveStarMetal,k=v.imgInactiveStarWood,D=v.imgInactiveStarEarth,S=v.imgInactiveStarWater,W=v.imgInactiveStarFire,C=v.imgFrame,R=v.imgTypeCivilian,V=v.imgTypeWorker,F=v.imgTypeDignitary,A=v.imgTypeDivine,L=v.imgTypeWild,_=v.imgTypeInvader,M=v.imgTypeDemon,K=v.imgTypeFrame,B=[y,x,I,N,w],G=[T,k,D,S,W],H=b.a.CIVILIAN,q=b.a.WORKER,z=b.a.DIGNITARY,P=b.a.DIVINE,Y=b.a.WILD,J=b.a.INVADER,U=b.a.DEMON,Q=(n={},Object(o.a)(n,H,R),Object(o.a)(n,q,V),Object(o.a)(n,z,F),Object(o.a)(n,P,A),Object(o.a)(n,Y,L),Object(o.a)(n,J,_),Object(o.a)(n,U,M),n),X=a(39),Z=a(41),$=a(50),ee=(a(109),a(35)),te=a(120),ae=(a(527),a(22)),ne=a(1),ie=function(e){var t=e.canvas,a=e.rank,n=void 0===a?2:a,i=e.thumbnail,c=e.element,r=void 0===c?0:c,l=e.type,s=void 0===l?b.a.CIVILIAN:l,d=t.getContext("2d");d.clearRect(0,0,Z.d,Z.b),d.drawImage(B[r],0,0),i&&d.drawImage(i,17,17,275,374);for(var m=function(e,t){return d.drawImage(e,94+33*t,398)},o=0;o<=n;o+=1)m(E,o);for(var u=n+1;u<=4;u+=1)m(G[r],u);d.drawImage(C,0,0),d.drawImage(Q[s],13,376),d.drawImage(K,9,374)},ce=function(e){return te.a().shape({name:te.b().trim().required("T\xean l\xe1 b\xe0i kh\xf4ng \u0111\u01b0\u1ee3c \u0111\u1ec3 tr\u1ed1ng"),id:te.b().trim().required("Id kh\xf4ng \u0111\u01b0\u1ee3c \u0111\u1ec3 tr\u1ed1ng").notOneOf([e.value],e.text),thumbnail:te.b().required("\u1ea2nh kh\xf4ng \u0111\u01b0\u1ee3c \u0111\u1ec3 tr\u1ed1ng")})};t.a=function(e){var t=e.id,a=Object($.b)(),n=a.apiGet,o=a.request,j=Object(ae.g)(),h=Object(m.useState)(u),f=Object(c.a)(h,2),O=f[0],v=f[1],y=Object(m.useState)(!1),x=Object(c.a)(y,2),I=x[0],N=x[1],w=Object(m.useState)({value:"",text:""}),E=Object(c.a)(w,2),T=E[0],k=E[1],D=Object(m.useRef)(!!t),S=Object(m.useRef)(),W=Object(m.useRef)(null);Object(m.useEffect)((function(){var e;return g=!t,O||(e=setInterval((function(){u&&(v(!0),clearInterval(e))}),100)),function(){clearInterval(e)}}),[]);var C=Object(d.c)({initialValues:b.b,enableReinitialize:!0,validationSchema:ce(T),validateOnChange:!1,validateOnBlur:!0,onSubmit:function(e,a){var n=e.name,i=e.id,c=e.type,r=e.element,l=e.description,s=e.attack,d=e.defend,m=e.army,b=e.probability_register,u=a.validateForm;N(!0),r=Number(r),s=Number(s),d=Number(d),m=Number(m),b=Number(b);var h=document.createElement("canvas");h.width=Z.d,h.height=Z.b;var f=document.createElement("canvas");f.width=Z.c,f.height=Z.a;var O=f.getContext("2d"),v=function(){o(t?"put":"post",ee.b.adminCards(t),{id:t?void 0:i,name:n,description:l,type:c,element:r,attack:s,defend:d,army:m,probability_register:b},(function(e){var t=e.id,a=e.status,n=e.text;N(!1),a?j.push("/admin/the-bai"):"3"===t&&(k({value:i||"",text:n}),u())}))};if(g){g=!1;for(var y=[],x=0,I=function(e){ie({canvas:h,thumbnail:P,rank:e,type:c,element:r}),null===O||void 0===O||O.drawImage(h,0,0,Z.c,Z.a),f.toBlob((function(t){var a=new File([t],"".concat(i,"/").concat(e,".png"));y.push({file:a,name:a.name}),5===(x+=1)&&(y.push({file:p,name:"".concat(i,"/thumbnail.png")}),function(e){var t=e.files,a=e.prefix,n=e.onSuccess,i=e.contentType;$.a.post("/api/v1/upload",{prefix:a,file_names:t.map((function(e){return e.name}))},(function(e){var a=e.status,c=e.data;if(a){var r=new Headers;r.append("x-amz-acl","public-read"),i&&r.append("content-type",i);var l=0,s=c.length;c.forEach((function(e,a){var i=e.upload_link,c={method:"PUT",headers:r,body:t[a].file,redirect:"follow"};fetch(i,c).then((function(e){return e.text()})).then((function(){(l+=1)===s&&(null===n||void 0===n||n())})).catch((function(e){return console.log("error",e)}))}))}}))}({files:y,prefix:"cards",onSuccess:v,contentType:"image/png"}))}),"image/png",.85)},w=0;w<5;w+=1)I(w)}else v()}}),R=C.handleSubmit,V=C.getFieldProps,F=C.values,A=C.setFieldValue,L=C.setValues,_=C.handleChange,M=C.isSubmitting,K=C.touched,B=C.errors,G=C.handleBlur,H=(C.setFieldError,F.name),q=F.type,z=F.thumbnail,P=F.imgThumbnail,Y=F.element;Object(m.useEffect)((function(){t&&n(ee.b.adminCards(t),{},(function(e){var a=e.status,n=e.data;a&&L({id:t,name:n.name,type:""+n.type,element:""+n.element,thumbnail:n.thumbnail,imgThumbnail:null,probability_register:""+n.probability_register,description:n.description,attack:""+n.attack,defend:""+n.defend,army:""+n.army})}))}),[t]),Object(m.useEffect)((function(){W.current&&O&&ie({canvas:W.current,thumbnail:P,type:q,element:Y})}),[W,O,q,P,Y]),Object(m.useEffect)((function(){if(z){var e=new Image;e.src=z,e.onload=function(){A("imgThumbnail",e)}}}),[z]);var J=function(){var e;if(!D.current){var t=(null===(e=S.current)||void 0===e?void 0:e.value)||"";t&&(A("id",Object(X.b)(t)),D.current=!0)}};return Object(ne.jsxs)(ne.Fragment,{children:[!!t&&Object(ne.jsxs)(s.n,{children:["Th\u1ebb b\xe0i ",H||t]}),Object(ne.jsx)(d.b,{value:C,children:Object(ne.jsxs)(d.a,{className:"row pd-big",autoComplete:"off",noValidate:!0,onSubmit:R,children:[Object(ne.jsx)("div",{className:"col-8",children:Object(ne.jsxs)(r.a,{style:{paddingBottom:0},children:[Object(ne.jsxs)("div",{className:"row",children:[Object(ne.jsxs)("div",{className:"col-6 form-stack",children:[Object(ne.jsx)("div",{className:"form-title",children:"Th\xf4ng tin"}),Object(ne.jsx)(s.d,Object(i.a)(Object(i.a)({inputRef:S,label:"T\xean th\u1ebb b\xe0i"},V("name")),{},{onKeyDown:function(e){"Enter"===e.key&&J()},onBlur:function(e){G(e),J()},disabled:I,maxLength:36,error:B.name,errorEmpty:M||K.name})),Object(ne.jsx)(s.d,Object(i.a)(Object(i.a)({label:"ID th\u1ebb b\xe0i"},V("id")),{},{onChange:function(e){_(e),D.current=!0},maxLength:36,error:F.id?"":B.id,errorEmpty:M||K.id,errorFocused:!!T.value&&F.id===T.value,disabled:!!t})),Object(ne.jsx)(s.l,{fullWidth:!0,label:"Nh\xf3m",data:b.d,selected:q,setSelected:function(e){g=!0,A("type",e)}}),Object(ne.jsx)(s.l,{fullWidth:!0,label:"H\u1ec7",data:b.c,selected:Y,setSelected:function(e){g=!0,A("element",e)}}),Object(ne.jsx)(s.e,Object(i.a)(Object(i.a)({label:"T\u1ec9 l\u1ec7 xu\u1ea5t hi\u1ec7n"},V("probability_register")),{},{InputProps:{endAdornment:Object(ne.jsx)(l.a,{position:"end",children:"%"})},min:0,max:100})),Object(ne.jsx)(s.d,Object(i.a)({label:"Th\xf4ng tin",rows:3,multiline:!0},V("description")))]}),Object(ne.jsxs)("div",{className:"col-6 d-f ai-c fd-c",style:{marginBottom:0},children:[Object(ne.jsx)("div",{className:"form-title",children:"\u1ea2nh th\u1ebb b\xe0i"}),Object(ne.jsx)(s.b,{image:z,onChosen:function(e,t){p=t,g=!0,A("thumbnail",e)},className:"AdminCards-chooseThumbnail",error:(M||K.thumbnail)&&B.thumbnail}),Object(ne.jsx)("div",{className:"form-title mt-2",children:"Ch\u1ec9 s\u1ed1"}),Object(ne.jsxs)("div",{className:"row jc-c",style:{width:"75%"},children:[Object(ne.jsx)("div",{className:"col-6",children:Object(ne.jsx)(s.e,Object(i.a)(Object(i.a)({label:"C\xf4ng"},V("attack")),{},{min:10,max:50}))}),Object(ne.jsx)("div",{className:"col-6",children:Object(ne.jsx)(s.e,Object(i.a)(Object(i.a)({label:"Th\u1ee7"},V("defend")),{},{min:10,max:50}))}),Object(ne.jsx)("div",{className:"col-6",children:Object(ne.jsx)(s.e,Object(i.a)(Object(i.a)({label:"L\xednh"},V("army")),{},{min:10,max:50}))})]})]})]}),Object(ne.jsx)("div",{className:"form-title mt-1",children:"K\u1ef9 n\u0103ng"}),Object(ne.jsxs)("div",{className:"row",children:[Object(ne.jsx)("div",{className:"col-6 form-stack",children:Object(ne.jsx)(s.d,Object(i.a)({label:"Tr\u01b0\u1edfng t\xe0i",rows:3,multiline:!0},V("primary_skill")))}),Object(ne.jsx)("div",{className:"col-6 form-stack",children:Object(ne.jsx)(s.d,Object(i.a)({label:"Hi\u1ec7u t\xe0i",rows:3,multiline:!0},V("secondary_skill")))})]})]})}),Object(ne.jsxs)("div",{className:"col-4",children:[Object(ne.jsx)(r.a,{className:"d-f ai-c jc-c",children:Object(ne.jsx)("canvas",{ref:W,width:Z.d,height:Z.b,style:{borderRadius:8}})}),Object(ne.jsx)("div",{className:"mt-3 d-f jc-c",children:Object(ne.jsxs)(s.a,{type:"submit",variant:"contained",style:{fontSize:15,fontWeight:"600",width:160,height:38},loading:I,children:[t?"S\u1eeda":"Th\xeam"," th\u1ebb b\xe0i"]})})]})]})})]})}},536:function(e,t,a){"use strict";a.r(t);a(0);var n=a(528),i=a(1);t.default=function(){return Object(i.jsx)(n.a,{})}}}]);