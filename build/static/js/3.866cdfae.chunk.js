(this["webpackJsonpDVKN-frontend"]=this["webpackJsonpDVKN-frontend"]||[]).push([[3],{524:function(e,t,a){"use strict";a.d(t,"e",(function(){return m})),a.d(t,"c",(function(){return b})),a.d(t,"a",(function(){return u})),a.d(t,"f",(function(){return y})),a.d(t,"d",(function(){return x})),a.d(t,"b",(function(){return I}));var n,i,c=a(5),r="0",l="1",s="2",d="3",o="4",m=(n={},Object(c.a)(n,r,"Kim"),Object(c.a)(n,l,"M\u1ed9c"),Object(c.a)(n,s,"Th\u1ed5"),Object(c.a)(n,d,"Th\u1ee7y"),Object(c.a)(n,o,"H\u1ecfa"),n),b=Object.keys(m).map((function(e){return{value:e,label:m[e]}})),u={CIVILIAN:"0",WORKER:"1",DIGNITARY:"2",DIVINE:"3",WILD:"4",INVADER:"5",DEMON:"6"},j=u.CIVILIAN,f=u.WORKER,h=u.DIGNITARY,O=u.DIVINE,v=u.WILD,p=u.INVADER,g=u.DEMON,y=(i={},Object(c.a)(i,j,"D\xe2n th\u01b0\u1eddng"),Object(c.a)(i,f,"S\u1ea3n xu\u1ea5t"),Object(c.a)(i,h,"Ch\u1ee9c s\u1eafc"),Object(c.a)(i,O,"Th\u1ea7n t\u1ed9c"),Object(c.a)(i,v,"Hoang d\xe3"),Object(c.a)(i,p,"Gi\u1eb7c"),Object(c.a)(i,g,"Ma t\u1ed9c"),i),x=Object.keys(y).map((function(e){return{value:e,label:y[e]}})),I={id:"",name:"",type:j,element:r,thumbnail:"",imgThumbnail:null,probability_register:"100",description:"",attack:"50",defend:"50",army:"50",captain_skill:"",specific_skill:""}},525:function(e,t,a){},526:function(e,t,a){"use strict";var n,i=a(13),c=a(11),r=a(517),l=a(508),s=a(23),d=a(118),o=a(0),m=a(5),b=a(524),u=!1,j=0,f={elementMetal:"element-metal",elementWood:"element-wood",elementEarth:"element-earth",elementWater:"element-water",elementFire:"element-fire",star:"star",inactiveStarMetal:"inactive-star-metal",inactiveStarWood:"inactive-star-wood",inactiveStarEarth:"inactive-star-earth",inactiveStarWater:"inactive-star-water",inactiveStarFire:"inactive-star-fire",frame:"frame",typeCivilian:"type-civilian",typeWorker:"type-worker",typeDignitary:"type-dignitary",typeDivine:"type-divine",typeWild:"type-wild",typeInvader:"type-invader",typeDemon:"type-demon",typeFrame:"type-frame"},h=Object.keys(f).length,O=function(){(j+=1)===h&&(u=!0)},v={};Object.keys(f).forEach((function(e){var t="img".concat(e[0].toUpperCase()).concat(e.slice(1));v[t]=new Image,v[t].src="/create-card/".concat(f[e],".png"),v[t].onload=O}));var p,g,y=v.imgElementMetal,x=v.imgElementWood,I=v.imgElementEarth,N=v.imgElementWater,k=v.imgElementFire,w=v.imgStar,T=v.imgInactiveStarMetal,E=v.imgInactiveStarWood,D=v.imgInactiveStarEarth,S=v.imgInactiveStarWater,R=v.imgInactiveStarFire,W=v.imgFrame,C=v.imgTypeCivilian,_=v.imgTypeWorker,V=v.imgTypeDignitary,L=v.imgTypeDivine,A=v.imgTypeWild,F=v.imgTypeInvader,M=v.imgTypeDemon,K=v.imgTypeFrame,B=[y,x,I,N,k],G=[T,E,D,S,R],H=b.a.CIVILIAN,q=b.a.WORKER,U=b.a.DIGNITARY,z=b.a.DIVINE,P=b.a.WILD,Y=b.a.INVADER,J=b.a.DEMON,Q=(n={},Object(m.a)(n,H,C),Object(m.a)(n,q,_),Object(m.a)(n,U,V),Object(m.a)(n,z,L),Object(m.a)(n,P,A),Object(m.a)(n,Y,F),Object(m.a)(n,J,M),n),X=a(39),Z=a(32),$=a(50),ee=(a(108),a(36)),te=a(119),ae=(a(525),a(22)),ne=a.p+"static/media/default_card_thumbnail.f70133fb.jpg",ie=a(1),ce=function(e){var t=e.canvas,a=e.rank,n=void 0===a?2:a,i=e.thumbnail,c=e.element,r=void 0===c?0:c,l=e.type,s=void 0===l?b.a.CIVILIAN:l,d=t.getContext("2d");d.clearRect(0,0,Z.d,Z.b),d.drawImage(B[r],0,0),i&&d.drawImage(i,17,17,275,374);for(var o=function(e,t){return d.drawImage(e,94+33*t,398)},m=0;m<=n;m+=1)o(w,m);for(var u=n+1;u<=4;u+=1)o(G[r],u);d.drawImage(W,0,0),d.drawImage(Q[s],13,376),d.drawImage(K,9,374)},re=function(e){return te.a().shape({name:te.b().trim().required("T\xean l\xe1 b\xe0i kh\xf4ng \u0111\u01b0\u1ee3c \u0111\u1ec3 tr\u1ed1ng"),id:te.b().trim().required("Id kh\xf4ng \u0111\u01b0\u1ee3c \u0111\u1ec3 tr\u1ed1ng").notOneOf([e.value],e.text),thumbnail:te.b().required("\u1ea2nh kh\xf4ng \u0111\u01b0\u1ee3c \u0111\u1ec3 tr\u1ed1ng")})};t.a=function(e){var t=e.id,a=Object($.b)(),n=a.apiGet,m=a.request,j=Object(ae.g)(),f=Object(o.useState)(u),h=Object(c.a)(f,2),O=h[0],v=h[1],y=Object(o.useState)(!1),x=Object(c.a)(y,2),I=x[0],N=x[1],k=Object(o.useState)({value:"",text:""}),w=Object(c.a)(k,2),T=w[0],E=w[1],D=Object(o.useRef)(!!t),S=Object(o.useRef)(),R=Object(o.useRef)(null);Object(o.useEffect)((function(){var e;return g=!t,O||(e=setInterval((function(){u&&(v(!0),clearInterval(e))}),100)),function(){clearInterval(e)}}),[]);var W=Object(d.c)({initialValues:b.b,enableReinitialize:!0,validationSchema:re(T),validateOnChange:!1,validateOnBlur:!0,onSubmit:function(e,a){var n=e.name,i=e.id,c=e.type,r=e.element,l=e.description,s=e.attack,d=e.defend,o=e.army,b=e.probability_register,u=e.captain_skill,f=e.specific_skill,h=a.validateForm;N(!0),r=Number(r),s=Number(s),d=Number(d),o=Number(o),b=Number(b);var O=document.createElement("canvas");O.width=Z.d,O.height=Z.b;var v=document.createElement("canvas");v.width=Z.c,v.height=Z.a;var y=v.getContext("2d"),x=function(){m(t?"put":"post",ee.b.adminCards(t),{id:t?void 0:i,name:n,description:l,type:c,element:r,attack:s,defend:d,army:o,probability_register:b,captain_skill:u,specific_skill:f},(function(e){var t=e.id,a=e.status,n=e.text;N(!1),a?j.push("/admin/the-bai"):"3"===t&&(E({value:i||"",text:n}),h())}))};if(g){g=!1;for(var I=[],k=0,w=function(e){ce({canvas:O,thumbnail:z,rank:e,type:c,element:r}),null===y||void 0===y||y.drawImage(O,0,0,Z.c,Z.a),v.toBlob((function(t){var a=new File([t],"".concat(i,"/").concat(e,".png"));if(I.push({file:a,name:a.name}),5===(k+=1)){var n=function(){return function(e){var t=e.files,a=e.prefix,n=e.onSuccess,i=e.contentType;$.a.post("/api/v1/upload",{prefix:a,file_names:t.map((function(e){return e.name}))},(function(e){var a=e.status,c=e.data;if(a){var r=new Headers;r.append("x-amz-acl","public-read"),i&&r.append("content-type",i);var l=0,s=c.length;c.forEach((function(e,a){var i=e.upload_link,c={method:"PUT",headers:r,body:t[a].file,redirect:"follow"};fetch(i,c).then((function(e){return e.text()})).then((function(){(l+=1)===s&&(null===n||void 0===n||n())})).catch((function(e){return console.log("error",e)}))}))}}))}({files:I,prefix:"cards",onSuccess:x,contentType:"image/png"})};p?Object(X.f)(URL.createObjectURL(p),275,374,(function(e){I.push({file:e,name:"".concat(i,"/thumbnail.png")}),n()})):n()}}),"image/png",.85)},T=0;T<5;T+=1)w(T)}else x()}}),C=W.handleSubmit,_=W.getFieldProps,V=W.values,L=W.setFieldValue,A=W.setValues,F=W.handleChange,M=W.isSubmitting,K=W.touched,B=W.errors,G=W.handleBlur,H=V.name,q=V.type,U=V.thumbnail,z=V.imgThumbnail,P=V.element;Object(o.useEffect)((function(){t&&n(ee.b.adminCards(t),{},(function(e){var a=e.status,n=e.data;a&&A(Object(i.a)(Object(i.a)({},n),{},{id:t,type:""+n.type,element:""+n.element,imgThumbnail:null,probability_register:""+n.probability_register,attack:""+n.attack,defend:""+n.defend,army:""+n.army}))}))}),[t]),Object(o.useEffect)((function(){R.current&&O&&ce({canvas:R.current,thumbnail:z,type:q,element:P})}),[R,O,q,z,P]),Object(o.useEffect)((function(){var e=new Image;e.setAttribute("crossorigin","anonymous"),e.src=U||ne,e.onload=function(){L("imgThumbnail",e)}}),[U]);var Y=function(){var e;if(!D.current){var t=(null===(e=S.current)||void 0===e?void 0:e.value)||"";t&&(L("id",Object(X.b)(t)),D.current=!0)}};return Object(ie.jsxs)(ie.Fragment,{children:[Object(ie.jsx)(s.n,{hasGoBack:!0,children:t?"Th\u1ebb b\xe0i ".concat(H||t):"Th\xeam Th\u1ebb b\xe0i"}),Object(ie.jsx)(d.b,{value:W,children:Object(ie.jsxs)(d.a,{className:"row pd-big",autoComplete:"off",noValidate:!0,onSubmit:C,children:[Object(ie.jsx)("div",{className:"col-8",children:Object(ie.jsxs)(r.a,{style:{paddingBottom:0},children:[Object(ie.jsxs)("div",{className:"row",children:[Object(ie.jsxs)("div",{className:"col-6 form-stack",children:[Object(ie.jsx)("div",{className:"form-title",children:"Th\xf4ng tin"}),Object(ie.jsx)(s.d,Object(i.a)(Object(i.a)({inputRef:S,label:"T\xean th\u1ebb b\xe0i"},_("name")),{},{onKeyDown:function(e){"Enter"===e.key&&Y()},onBlur:function(e){G(e),Y()},disabled:I,maxLength:36,error:B.name,errorEmpty:M||K.name})),Object(ie.jsx)(s.d,Object(i.a)(Object(i.a)({label:"ID th\u1ebb b\xe0i"},_("id")),{},{onChange:function(e){F(e),D.current=!0},maxLength:36,error:V.id?"":B.id,errorEmpty:M||K.id,errorFocused:!!T.value&&V.id===T.value,disabled:!!t})),Object(ie.jsx)(s.l,{fullWidth:!0,label:"Nh\xf3m",data:b.d,selected:q,setSelected:function(e){g=!0,L("type",e)}}),Object(ie.jsx)(s.l,{fullWidth:!0,label:"H\u1ec7",data:b.c,selected:P,setSelected:function(e){g=!0,L("element",e)}}),Object(ie.jsx)(s.e,Object(i.a)(Object(i.a)({label:"T\u1ec9 l\u1ec7 xu\u1ea5t hi\u1ec7n"},_("probability_register")),{},{InputProps:{endAdornment:Object(ie.jsx)(l.a,{position:"end",children:"%"})},min:0,max:100})),Object(ie.jsx)(s.d,Object(i.a)({label:"Th\xf4ng tin",rows:3,multiline:!0,maxLength:500},_("description")))]}),Object(ie.jsxs)("div",{className:"col-6 d-f ai-c fd-c",style:{marginBottom:0},children:[Object(ie.jsx)("div",{className:"form-title",children:"\u1ea2nh th\u1ebb b\xe0i"}),Object(ie.jsx)(s.b,{image:U,onChosen:function(e,t){p=t,g=!0,L("thumbnail",e)},className:"AdminCards-chooseThumbnail",error:(M||K.thumbnail)&&B.thumbnail}),Object(ie.jsx)("div",{className:"form-title mt-2",children:"Ch\u1ec9 s\u1ed1"}),Object(ie.jsxs)("div",{className:"row jc-c",style:{width:"75%"},children:[Object(ie.jsx)("div",{className:"col-6",children:Object(ie.jsx)(s.e,Object(i.a)(Object(i.a)({label:"C\xf4ng"},_("attack")),{},{min:10,max:50}))}),Object(ie.jsx)("div",{className:"col-6",children:Object(ie.jsx)(s.e,Object(i.a)(Object(i.a)({label:"Th\u1ee7"},_("defend")),{},{min:10,max:50}))}),Object(ie.jsx)("div",{className:"col-6",children:Object(ie.jsx)(s.e,Object(i.a)(Object(i.a)({label:"L\xednh"},_("army")),{},{min:10,max:50}))})]})]})]}),Object(ie.jsx)("div",{className:"form-title mt-1",children:"K\u1ef9 n\u0103ng"}),Object(ie.jsxs)("div",{className:"row",children:[Object(ie.jsx)("div",{className:"col-6 form-stack",children:Object(ie.jsx)(s.d,Object(i.a)({label:"Tr\u01b0\u1edfng t\xe0i",rows:3,multiline:!0,maxLength:500},_("captain_skill")))}),Object(ie.jsx)("div",{className:"col-6 form-stack",children:Object(ie.jsx)(s.d,Object(i.a)({label:"Hi\u1ec7u t\xe0i",rows:3,multiline:!0,maxLength:500},_("specific_skill")))})]})]})}),Object(ie.jsxs)("div",{className:"col-4",children:[Object(ie.jsx)(r.a,{className:"d-f ai-c jc-c",children:Object(ie.jsx)("canvas",{ref:R,width:Z.d,height:Z.b,style:{borderRadius:8}})}),Object(ie.jsx)("div",{className:"mt-3 d-f jc-c",children:Object(ie.jsxs)(s.a,{type:"submit",variant:"contained",style:{fontSize:15,fontWeight:"600",width:160,height:38},loading:I,children:[t?"S\u1eeda":"Th\xeam"," th\u1ebb b\xe0i"]})})]})]})})]})}},530:function(e,t,a){"use strict";a.r(t);a(0);var n=a(526),i=a(1);t.default=function(){return Object(i.jsx)(n.a,{})}}}]);